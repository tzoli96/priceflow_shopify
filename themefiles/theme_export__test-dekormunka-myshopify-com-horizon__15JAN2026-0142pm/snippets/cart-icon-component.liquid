
{%- doc -%}
  Renders the cart icon, which displays the number of items in the cart via a bubble.

  MODIFIED: Opens PriceFlow minicart drawer instead of native cart page.
{%- enddoc -%}

<cart-icon
  class="
    header-actions__cart-icon
    header-actions__cart-icon--priceflow
  "
  data-testid="cart-icon"
  data-priceflow-cart-icon
>
  <a
    href="#"
    onclick="openPriceflowCart(); return false;"
    aria-label="Open cart"
    class="cart-icon__link"
  >
    <span
      class="svg-wrapper"
      aria-hidden="true"
    >
      {{ 'icon-cart.svg' | inline_asset_content }}
    </span>

    {% render 'cart-bubble', limit: 100, live_region: true, test_id: test_id %}
  </a>
</cart-icon>

{% stylesheet %}
  cart-icon:has(.cart-bubble__text-count:empty) {
    --cart-bubble-size: 10px;
    --cart-bubble-top: 9px;
    --cart-bubble-right: 9px;

    .svg-wrapper {
      --cart-bubble-top: 4px;
      --cart-bubble-right: 4px;
    }
  }

  .cart-icon__link {
    display: inline-flex;
    align-items: center;
    position: relative;
    text-decoration: none;
    color: inherit;
  }
{% endstylesheet %}

<script>
  // Global functions for opening/closing cart drawer
  // These will be used by the priceflow-minicart section

  window.openPriceflowCart = function() {
    const drawer = document.getElementById('priceflow-minicart-drawer');
    if (drawer) {
      drawer.classList.add('is-open');
      document.body.style.overflow = 'hidden';
    } else {
      console.warn('PriceFlow minicart drawer not found. Make sure the priceflow-minicart section is included in theme.liquid');
    }
  };

  window.closePriceflowCart = function() {
    const drawer = document.getElementById('priceflow-minicart-drawer');
    if (drawer) {
      drawer.classList.remove('is-open');
      document.body.style.overflow = '';
    }
  };
</script>